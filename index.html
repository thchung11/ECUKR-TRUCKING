<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ìš´ì†¡ ìš”ê¸ˆ ê³„ì‚°ê¸°</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f9fafb;
      padding: 2rem;
    }
    .card {
      background: white;
      padding: 2rem;
      max-width: 600px;
      margin: auto;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border-radius: 10px;
    }
    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }
    input {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.25rem;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .result {
      margin-top: 2rem;
      font-size: 1.25rem;
      font-weight: bold;
      color: #16a34a;
    }
    .result.heavy {
      color: #dc2626;
    }
    .info {
      font-size: 0.85rem;
      margin-top: 1rem;
      color: #555;
      line-height: 1.4;
    }
    .error {
      margin-top: 1rem;
      color: #dc2626;
      font-weight: bold;
    }
    #showCityBtn {
      margin-top: 1rem;
      background: #3b82f6;
      color: white;
      padding: 0.6rem 1rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #showCityBtn:hover {
      background: #2563eb;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.4);
      z-index: 999;
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: #fff;
      padding: 2rem;
      max-width: 500px;
      width: 90%;
      border-radius: 10px;
      overflow-y: auto;
      max-height: 80vh;
    }
    .zone-group {
      margin-bottom: 1.5rem;
    }
    .zone-title {
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: #2563eb;
    }
    .city-button {
      display: inline-block;
      margin: 0.25rem;
      padding: 0.4rem 0.7rem;
      background: #e2e8f0;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .city-button:hover {
      background: #cbd5e1;
    }
    .close-btn {
      display: block;
      text-align: right;
      margin-bottom: 1rem;
      font-weight: bold;
      color: #999;
      cursor: pointer;
    }
    #adjustToggle {
      margin-top: 1.2rem;
    }
    #toggleAdjustBtn {
      background: #facc15;
      border: none;
      padding: 0.4rem 0.8rem;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2>ğŸšš ìš´ì†¡ ìš”ê¸ˆ ê³„ì‚°ê¸°</h2>

    <label for="city">ë„ì‹œ ì„ íƒ</label>
    <input list="cityList" id="city" placeholder="ë„ì‹œë¥¼ ì…ë ¥í•˜ê±°ë‚˜ ì„ íƒí•˜ì„¸ìš”" />
    <datalist id="cityList"></datalist>

    <label for="cbm">CBM ì…ë ¥</label>
    <input type="number" id="cbm" min="0" placeholder="ì˜ˆ: 7" />

    <label for="weight">í™”ë¬¼ì¤‘ëŸ‰ (kg)</label>
    <input type="number" id="weight" placeholder="ì¤‘ëŸ‰ í™”ë¬¼ì¸ ê²½ìš°ì—ë§Œ ì…ë ¥" />

    <label for="extra">ì¶”ê°€ ë¹„ìš©</label>
    <input type="number" id="extra" placeholder="0" min="0" step="10" />

    <!-- âœ… í† ê¸€ ë²„íŠ¼ ìœ„ì¹˜ ì´ë™ -->
    <div id="adjustToggle">
      <button id="toggleAdjustBtn">âœ… 5ë‹¬ëŸ¬ ì˜¬ë¦¼ ì ìš©ì¤‘</button>
    </div>

    <button id="showCityBtn">ğŸ“ ë„ì‹œ ëª©ë¡ ë³´ê¸°</button>

    <div class="error" id="errorMsg"></div>
    <div class="result" id="rate">ğŸ’° ìµœì¢… ìš´ì†¡ ìš”ê¸ˆ: -</div>

    <p class="info">
      Ver.1.14 <br>
      (ë„ì‹œ íŒì—…, ì¤‘ëŸ‰í™”ë¬¼ ìš°ì„  ì ìš©, 5ë‹¬ëŸ¬ ì¡°ì • ë²„íŠ¼ ì™¸ë¶€ ìœ„ì¹˜)<br>
      ê³„ì‚° í›„ <strong>5 ë‹¨ìœ„ ì˜¬ë¦¼ ì²˜ë¦¬</strong> + 5ë‹¬ëŸ¬ ì¶”ê°€ ì—¬ë¶€ ì„ íƒ ê°€ëŠ¥<br>
      Zone 7 ë˜ëŠ” 10í†¤ ì´ˆê³¼ ì¤‘ëŸ‰í™”ë¬¼ì€ ë‹´ë‹¹ì ë¬¸ì˜</p>
      ë¬¸ì œ ìˆìœ¼ë©´ ë„¤ì´íŠ¸ì˜¨ ì£¼ì„¸ìš”.. ì •íƒœí™” / benchung95@nate.com</p>
      https://docs.google.com/spreadsheets/d/18Dpyx1w5WbP9kCoYiaW1hGBA6PvPytlwJqYu9V3Ew2Q/edit?gid=0#gid=0</p>
    </p>
    <p class="info">Made by ì •íƒœí™” using ChatGPT.</p>
  </div>

  <div class="modal" id="cityModal">
    <div class="modal-content">
      <div class="close-btn" id="closeCityModal">âœ– ë‹«ê¸°</div>
      <div id="cityListContainer"></div>
    </div>
  </div>

  <script>
    const rateTable = {
      "ì–‘ì‚°": [100,115,130,145,160,175,190,205,220,235,250,265],
      "ê¹€í•´": [100,115,130,145,160,175,190,205,220,235,250,265],
      "ë¶€ì‚°": [100,115,130,145,160,175,190,205,220,235,250,265],
      "ì°½ì›": [120,135,150,165,180,195,210,225,240,255,270,285],
      "ì•ˆì‚°": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ì¸ì²œ": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ë¶€ì²œ": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ì‹œí¥": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ì˜ì™•": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ìˆ˜ì›": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ì•ˆì–‘": [130,145,160,175,190,205,220,235,250,265,280,295],
      "êµ°í¬": [130,145,160,175,190,205,220,235,250,265,280,295],
      "í™”ì„±": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ì˜¤ì‚°": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ìš©ì¸": [130,145,160,175,190,205,220,235,250,265,280,295],
      "í‰íƒ": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ëŒ€êµ¬": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ì˜ì²œ": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ê²½ì‚°": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ìš¸ì‚°": [130,145,160,175,190,205,220,235,250,265,280,295],
      "ì²œì•ˆ": [140,155,170,185,200,215,230,245,260,275,290,305],
      "ì„¸ì¢…": [140,155,170,185,200,215,230,245,260,275,290,305],
      "ì§„ì²œ": [140,155,170,185,200,215,230,245,260,275,290,305],
      "ìŒì„±": [140,155,170,185,200,215,230,245,260,275,290,305],
      "ê³¼ì²œ": [140,155,170,185,200,215,230,245,260,275,290,305],
      "ì„±ë‚¨": [140,155,170,185,200,215,230,245,260,275,290,305],
      "ê´‘ì£¼": [140,155,170,185,200,215,230,245,260,275,290,305],
      "ì´ì²œ": [140,155,170,185,200,215,230,245,260,275,290,305],
      "ì—¬ì£¼": [140,155,170,185,200,215,230,245,260,275,290,305],
      "ì•ˆì„±": [140,155,170,185,200,215,230,245,260,275,290,305],
      "êµ¬ë¯¸": [140,155,170,185,200,215,230,245,260,275,290,305],
      "ê³ ì–‘": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ì•„ì‚°": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ì„œìš¸": [150,165,180,195,210,225,240,255,270,285,300,315],
      "êµ¬ë¦¬": [150,165,180,195,210,225,240,255,270,285,300,315],
      "í•˜ë‚¨": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ë°€ì–‘": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ê¹€í¬": [150,165,180,195,210,225,240,255,270,285,300,315],
      "íŒŒì£¼": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ì–‘ì£¼": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ë™ë‘ì²œ": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ì˜ì •ë¶€": [150,165,180,195,210,225,240,255,270,285,300,315],
      "í¬ì²œ": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ë‚¨ì–‘ì£¼": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ì²­ì£¼": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ë³´ì€": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ì˜¥ì²œ": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ëŒ€ì „": [150,165,180,195,210,225,240,255,270,285,300,315],
      "í¬í•­": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ê´‘ì£¼ê´‘ì—­ì‹œ": [150,165,180,195,210,225,240,255,270,285,300,315],
      "ì²­ë„": [160,175,190,205,220,235,250,265,280,295,310,325],
      "ê²½ì£¼": [160,175,190,205,220,235,250,265,280,295,310,325],
      "êµ°ì‚°": [170,185,200,215,230,245,265,280,295,310,325,340],
      "ì™„ì£¼": [170,185,200,215,230,245,265,280,295,310,325,340],
      "ì „ì£¼": [170,185,200,215,230,245,265,280,295,310,325,340]
    };

    const heavyRateTable = {
      1: [100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300, 320, 340, 360, 380, 400, 420, 440, 460],
      2: [120, 140, 160, 180, 200, 220, 240, 260, 280, 300, 320, 340, 360, 380, 400, 420, 440, 460, 480],
      3: [130, 150, 170, 190, 210, 230, 250, 270, 290, 310, 330, 350, 370, 390, 410, 430, 450, 470, 490],
      4: [140, 160, 180, 200, 220, 240, 260, 280, 300, 320, 340, 360, 380, 400, 420, 440, 460, 480, 500],
      5: [150, 170, 190, 210, 230, 250, 270, 290, 310, 330, 350, 370, 390, 410, 430, 450, 470, 490, 510],
      6: [160, 180, 200, 220, 240, 260, 280, 300, 320, 340, 360, 380, 400, 420, 440, 460, 480, 500, 520]
    };

    const zoneMap = {
      1: ["ì–‘ì‚°", "ê¹€í•´", "ë¶€ì‚°"],
      2: ["ì°½ì›"],
      3: ["ì•ˆì‚°", "ì¸ì²œ", "ë¶€ì²œ", "ì‹œí¥", "ì˜ì™•", "ìˆ˜ì›", "ì•ˆì–‘", "êµ°í¬", "í™”ì„±", "ì˜¤ì‚°", "ìš©ì¸", "í‰íƒ", "ëŒ€êµ¬", "ì˜ì²œ", "ê²½ì‚°", "ìš¸ì‚°"],
      4: ["ì²œì•ˆ", "ì„¸ì¢…", "ì§„ì²œ", "ìŒì„±", "ê³¼ì²œ", "ì„±ë‚¨", "ê´‘ì£¼", "ì´ì²œ", "ì—¬ì£¼", "ì•ˆì„±", "êµ¬ë¯¸"],
      5: ["ê³ ì–‘", "ì•„ì‚°", "ì„œìš¸", "êµ¬ë¦¬", "í•˜ë‚¨", "ë°€ì–‘", "ê¹€í¬", "íŒŒì£¼", "ì–‘ì£¼", "ë™ë‘ì²œ", "ì˜ì •ë¶€", "í¬ì²œ", "ë‚¨ì–‘ì£¼", "ì²­ì£¼", "ë³´ì€", "ì˜¥ì²œ", "ëŒ€ì „", "í¬í•­", "ê´‘ì£¼ê´‘ì—­ì‹œ"],
      6: ["ì²­ë„", "ê²½ì£¼"],
      7: ["êµ°ì‚°", "ì™„ì£¼", "ì „ì£¼"]
    };

    const cityInput = document.getElementById("city");
    const cbmInput = document.getElementById("cbm");
    const weightInput = document.getElementById("weight");
    const extraInput = document.getElementById("extra");
    const rateDisplay = document.getElementById("rate");
    const errorMsg = document.getElementById("errorMsg");
    const cityList = document.getElementById("cityList");
    const showCityBtn = document.getElementById("showCityBtn");
    const cityModal = document.getElementById("cityModal");
    const cityListContainer = document.getElementById("cityListContainer");
    const closeCityModal = document.getElementById("closeCityModal");

    let applyFiveUp = true; // âœ… 5ë‹¬ëŸ¬ ì¶”ê°€ ì ìš© ì—¬ë¶€

    const toggleAdjustBtn = document.getElementById("toggleAdjustBtn");
    toggleAdjustBtn.addEventListener("click", () => {
      applyFiveUp = !applyFiveUp;
      toggleAdjustBtn.textContent = applyFiveUp ? "âœ… 5ë‹¬ëŸ¬ ì˜¬ë¦¼ ì ìš©ì¤‘" : "âŒ 5ë‹¬ëŸ¬ ì˜¬ë¦¼ ë¯¸ì ìš©";
      updateRate();
    });

    Object.keys(rateTable).forEach(city => {
      const option = document.createElement("option");
      option.value = city;
      cityList.appendChild(option);
    });

    showCityBtn.addEventListener("click", () => {
      cityModal.style.display = "flex";
    });

    closeCityModal.addEventListener("click", () => {
      cityModal.style.display = "none";
    });

    function createCityList() {
      cityListContainer.innerHTML = "";
      for (const [zone, cities] of Object.entries(zoneMap)) {
        const zoneDiv = document.createElement("div");
        zoneDiv.classList.add("zone-group");

        const title = document.createElement("div");
        title.classList.add("zone-title");
        title.textContent = `Zone ${zone}`;
        zoneDiv.appendChild(title);

        cities.forEach(city => {
          const cityBtn = document.createElement("span");
          cityBtn.classList.add("city-button");
          cityBtn.textContent = city;
          cityBtn.addEventListener("click", () => {
            cityInput.value = city;
            cityModal.style.display = "none";
            updateRate();
          });
          zoneDiv.appendChild(cityBtn);
        });

        cityListContainer.appendChild(zoneDiv);
      }
    }

    function findZone(city) {
      for (const [zone, cities] of Object.entries(zoneMap)) {
        if (cities.includes(city)) return parseInt(zone);
      }
      return null;
    }

    function updateRate() {
      const city = cityInput.value.trim();
      const cbmVal = parseFloat(cbmInput.value);
      const weightValRaw = weightInput.value.trim();
      const extraRaw = extraInput.value.trim();

      let extra = 0;
      if (extraRaw === "") {
        extra = 0;
      } else if (!/^\d+$/.test(extraRaw)) {
        errorMsg.textContent = "â— ì¶”ê°€ ë¹„ìš©ì€ 0 ì´ìƒì˜ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.";
        rateDisplay.textContent = "ğŸ’° ìµœì¢… ìš´ì†¡ ìš”ê¸ˆ: -";
        return;
      } else {
        extra = parseInt(extraRaw, 10);
        if (extra % 10 !== 0) {
          errorMsg.textContent = "â— ì¶”ê°€ ë¹„ìš©ì€ 10ë‹¨ìœ„ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.";
          rateDisplay.textContent = "ğŸ’° ìµœì¢… ìš´ì†¡ ìš”ê¸ˆ: -";
          return;
        }
      }

      if (!rateTable[city]) {
        errorMsg.textContent = "â— ìœ íš¨í•œ ë„ì‹œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.";
        rateDisplay.textContent = "ğŸ’° ìµœì¢… ìš´ì†¡ ìš”ê¸ˆ: -";
        return;
      }

      errorMsg.textContent = "";

      const cityRateArray = rateTable[city];
      let cbmIndex = 0;
      if (!isNaN(cbmVal) && cbmVal > 0) {
        cbmIndex = Math.min(Math.floor(cbmVal) - 1, cityRateArray.length - 1);
        if (cbmIndex < 0) cbmIndex = 0;
      }

      const weightVal = weightValRaw === "" ? null : Number(weightValRaw);
      let finalRate = 0;
      let isHeavy = false;
      const zone = findZone(city);

      if (weightVal !== null && !isNaN(weightVal) && zone !== null) {
        if (!isNaN(cbmVal) && cbmVal > 0 && weightVal < cbmVal * 1000) {
          finalRate = cityRateArray[cbmIndex];
        } else {
          isHeavy = true;
          let tonIndex = weightVal <= 1000 ? 0 : Math.min(Math.floor((weightVal - 1000) / 500), heavyRateTable[zone]?.length - 1);
          finalRate = heavyRateTable[zone][tonIndex];
        }
      } else {
        finalRate = cityRateArray[cbmIndex];
      }

      let total = finalRate + extra;
      total = Math.ceil(total / 5) * 5;

      // âœ… ì ìš© ì‹œ 5ë¡œ ëë‚˜ëŠ” ìˆ˜ì— 5 ì¶”ê°€
      if (applyFiveUp && total % 10 === 5) {
        total += 5;
      }

      rateDisplay.textContent = `ğŸ’° ìµœì¢… ìš´ì†¡ ìš”ê¸ˆ: ${total} ë‹¬ëŸ¬${isHeavy ? " (ì¤‘ëŸ‰í™”ë¬¼)" : ""}`;
      rateDisplay.className = "result";
      if (isHeavy) rateDisplay.classList.add("heavy");
    }

    cityInput.addEventListener("input", updateRate);
    cbmInput.addEventListener("input", updateRate);
    weightInput.addEventListener("input", updateRate);
    extraInput.addEventListener("input", updateRate);

    createCityList();
  </script>
</body>
</html>
